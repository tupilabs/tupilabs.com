<!doctype html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta name="description" content="Innovation and Open Source">
    <meta name="author" content="">
    <title>TupiLabs</title>
    <meta name="description" content="">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <meta name="mobile-web-app-capable" content="yes">
    
    <link rel="stylesheet" type="text/css" href="/semantic.min.css">
    <link rel="stylesheet" type="text/css" href="/site.css">
</head>
<body>
    <!-- Following Menu -->
    <div class="ui large top fixed menu">
        <div class="ui container">
            <a class="item" href="/"><i class="home icon"></i> Home</a>
            <a class="item" href="/work"><i class="terminal icon"></i> Work</a>
            <a class="item" href="/tutorials"><i class="book icon"></i> Tutorials</a>
            <a class="item" href="/blog"><i class="newspaper icon"></i> Blog</a>
            <a class="item" href="/courses"><i class="student icon"></i> Courses</a>
            <a class="item" href="/lab"><i class="lab icon"></i> Lab</a>
            <div class="right menu">
                <a class="item" href="/contact"><i class="mail outline icon"></i> Contact</a>
            </div>
        </div>
    </div>
    
    <!-- Page Contents -->
    <div class="pusher">
        <div class="ui container">
            <div class="ui large stackable menu">
                <a class="item" href="/"><i class="home icon"></i> Home</a>
                <a class="item" href="/work"><i class="terminal icon"></i> Work</a>
                <a class="item" href="/tutorials"><i class="book icon"></i> Tutorials</a>
                <a class="item" href="/blog"><i class="newspaper icon"></i> Blog</a>
                <a class="item" href="/courses"><i class="student icon"></i> Courses</a>
                <a class="item" href="/lab"><i class="lab icon"></i> Lab</a>
                <div class="right menu">
                    <a class="item" href="/contact"><i class="mail outline icon"></i> Contact</a>
                </div>
            </div>
        </div>
        
        
        

<div class="ui basic segment" id="blog">
    <div class="ui stackable grid container">
        <div class="row">
            <div class="sixteen wide column">
                <h1>Posts tagged with php</h1>
            </div>
        </div>
        <div class="row">
            <div class="sixteen wide column">
                <section>
                    
                    <div class="ui padded segment">
  <article>
    <header>
      <h2><a href="/2014/08/11/on-using-laravel-with-the-repository-pattern-and-eloquent">On using Laravel with the repository pattern and Eloquent</a></h2>
      <small>Aug 11, 2014
        
        in 
            <a href="/tag/laravel">laravel</a>, <a href="/tag/php">php</a>
        
        
        | <a href="/blog">blog</a>
        
      </small>
    </header>
    <section>
      <p><a href="http://en.wikipedia.org/wiki/Separation_of_concerns">Separation of concerns</a> is a design principle, and 
states that each part of a software addresses a separate concern. Different patterns and abstractions 
can be used for that like MVC, DAOs and repositories.</p>
<p>Repositories help in the abstraction of the data layer. It provides an interface for retrieving data, 
independent of the implementation, acting like a collection of objects.</p>
<figure style='text-align: center'>
<img src="/2014/08/11/on-using-laravel-with-the-repository-pattern-and-eloquent/RepositoryDiagram.png" alt="From: http://blog.8thlight.com/mike-ebert/2013/03/23/the-repository-pattern.html"/>
<figcaption>Fig1. - Repositories <i>http://blog.8thlight.com/mike-ebert/2013/03/23/the-repository-pattern.html</i></figcaption>
</figure>

<p>In <a href="http://nestor-qa.org">Nestor-QA</a> I had implemented repositories using some Java code I had in my 
mind, without paying too much attention to the abstraction layers. Two weeks ago, while working on some 
complicated issue in Nestor I noticed that the repositories in Nestor had been implemented using the 
Eloquent classes.</p>
<p>Eloquent is a library used in Laravel for data abstraction. It provides access to databases like MySQL 
and SQLite, kind like DAOs (and sometimes like repositories too). However, for Nestor being a test 
management tool, we are trying to be platform and framework independent. Here&#8217;s the old repository code in 
action: </p>
<div class="highlight"><pre><span class="x">class DbProjectRepository implements ProjectRepository {</span>

<span class="x">    public function all()</span>
<span class="x">    {</span>
<span class="x">        return Project::where(&#39;project_statuses_id&#39;, &#39;&lt;&gt;&#39;, 2)-&gt;get();</span>
<span class="x">    }</span>

<span class="x">    // ...</span>

<span class="x">}</span>
</pre></div>

<p>As you can see, we were returning the result of the get() method from Eloquent. Another big mistake was 
using these objects in the views. In the end we were not only using data layer elements in the wrong place, 
but we also had many queries to render an UI. </p>
<div class="highlight"><pre><span class="x">abstract class DbBaseRepository extends BaseRepository {</span>

<span class="x">    protected $model;</span>

<span class="x">    public function __construct($model)</span>
<span class="x">    {</span>
<span class="x">        $this-&gt;model = $model;</span>
<span class="x">    }</span>

<span class="x">    public function all()</span>
<span class="x">    {</span>
<span class="x">        return $this-&gt;model-&gt;all()-&gt;toArray();</span>
<span class="x">    }</span>

<span class="x">    // ...</span>
<span class="x">}</span>
</pre></div>

<p>After searching for a while, I found a <a href="https://github.com/samgreenwood/swapshop/tree/master/app/Swapshop/Repositories">nice example</a> 
of a class design for repositories, where the return type is always an array. In the views you will 
have the array and keys, and in case someday you decide moving to another framework, you can leave the 
views unchanged (hopefully :-). Neat, no?</p>
<p><img alt="Ahn ahn" src="/2014/08/11/on-using-laravel-with-the-repository-pattern-and-eloquent/SA1HWow.gif" /></p>
<p>Happy hacking</p>
    </section>
  </article>
</div>
                    
                    <div class="ui padded segment">
  <article>
    <header>
      <h2><a href="/2013/06/09/tupilabs-report-02-jun-08-jun">TupiLabs Report: 02 Jun, 08 Jun</a></h2>
      <small>Jun 09, 2013
        
        in 
            <a href="/tag/tupilabs-report">tupilabs-report</a>, <a href="/tag/paskuale">paskuale</a>, <a href="/tag/piecrust">piecrust</a>, <a href="/tag/php">php</a>
        
        
        | <a href="/news">news</a>
        
      </small>
    </header>
    <section>
      <p>Here&#8217;s the list of the cool things that happened at TupiLabs since last Sunday.</p>
<ul>
<li><a href="http://www.paskuale.com">Paskuale</a> backend services running in production for the first time. Just have to finish the dictionaries and remaining tools to see the first results.</li>
<li>Added more features to a Hostel system we&#8217;ve been working on</li>
<li><a href="https://github.com/ludovicchabant/bolt80.com/pull/5">https://github.com/ludovicchabant/bolt80.com/pull/5</a></li>
<li><a href="https://github.com/ludovicchabant/PieCrust/issues/90">https://github.com/ludovicchabant/PieCrust/issues/90</a></li>
</ul>
<p>We are working <a href="for_you/">for you</a></p>
<p>Have a great week! :-)</p>
    </section>
  </article>
</div>
                    
                    <div class="ui padded segment">
  <article>
    <header>
      <h2><a href="/2013/06/02/tupilabs-report-26-may-01-jun">TupiLabs Report: 26 May, 01 Jun</a></h2>
      <small>Jun 02, 2013
        
        in 
            <a href="/tag/tupilabs-report">tupilabs-report</a>, <a href="/tag/slbr">slbr</a>, <a href="/tag/nlp">nlp</a>, <a href="/tag/uima">uima</a>, <a href="/tag/piecrust">piecrust</a>, <a href="/tag/php">php</a>, <a href="/tag/codeigniter">codeigniter</a>
        
        
        | <a href="/news">news</a>
        
      </small>
    </header>
    <section>
      <p>Here&#8217;s the list of the cool things that happened at TupiLabs since last Sunday.</p>
<ul>
<li>Mother&#8217;s week summary <a href="http://speaklikeabrazilian.com/blog/2013/05/26/mothers-week-expressions.html">post</a> 
in <a href="http://www.speaklikeabrazilian.com">SLBR</a></li>
<li>Migrated <a href="http://www.kinoshita.eti.br">kinoshita.eti.br</a> to PieCrust + Ant, like 
TupiLabs website.</li>
<li><a href="//2013/05/26/codeigniter-and-piecrust-integration">Blog post</a> explaining how to use CodeIgniter + PieCrust</li>
<li><a href="http://uima.apache.org">Apache UIMA</a> + <a href="http://www.nltk.org">NLTK</a> + 
<a href="http://opennlp.apache.org">OpenNLP</a> prototype.</li>
<li>Started setting up <a href="http://www.paskuale.com">Paskuale</a> backend services in production</li>
</ul>
<p>We are workingÂ <a href="for_you/">for you</a></p>
<p>Have a great week! :-)</p>
    </section>
  </article>
</div>
                    
                    <div class="ui padded segment">
  <article>
    <header>
      <h2><a href="/2013/05/26/codeigniter-and-piecrust-integration">CodeIgniter and PieCrust integration</a></h2>
      <small>May 26, 2013
        
        in 
            <a href="/tag/php">php</a>
        
        
        | <a href="/blog">blog</a>
        
      </small>
    </header>
    <section>
      <p>In of our largest web applications is <a href="http://www.speaklikeabrazilian.com">Speak Like A Brazilian</a>. 
We&#8217;ve been working to Open Source it, but first we have to double check the security 
aspects of this procedure, as well as review the source code.</p>
<p>Recently we added a blog to Speak Like A Brazilian. Navigating in the Internet, we 
found many tutorials for adding a blog engine to web applications using 
<a href="http://ellislab.com/codeigniter">CodeIgniter</a>.</p>
<p>Since the blog is limited to moderators or developers, we decided to use a 
static content generator, preferably one that supported <em>Markdown</em>. 
We opted for <a href="http://www.bolt80.com/piecrust">PieCrust</a>, and after few tests we were delighted by the 
flexibility and modularity.</p>

    </section>
  </article>
</div>
                    
                    <div class="ui padded segment">
  <article>
    <header>
      <h2><a href="/2013/05/26/escaping-twig-macros-in-geshi">Escaping Twig macros in Geshi</a></h2>
      <small>May 26, 2013
        
        in 
            <a href="/tag/php">php</a>
        
        
        | <a href="/blog">blog</a>
        
      </small>
    </header>
    <section>
      <p>While writing the <a href="//2013/05/26/creating-a-twig-macro-for-piecrust">last post</a>, I had some trouble trying to escape a Twig macro 
when using Geshi for syntax highlighting. Here&#8217;s the trick to escape it: 
<em><a href="http://twig.sensiolabs.org/doc/tags/raw.html">raw</a></em>.</p>
<p>The <em>raw</em> Twig tag prints the subsequent tags without interpreting it.</p>
<div class="highlight"><pre><span class="cp">{%</span><span class="k">geshi</span> <span class="s1">&#39;twig&#39;</span><span class="cp">%}</span><span class="x"></span>
<span class="x">{ %raw%}</span><span class="cp">{%</span> <span class="k">macro</span> <span class="nv">button</span><span class="o">(..</span><span class="p">.</span><span class="o">)</span> <span class="cp">%}</span><span class="x">{ %endraw%}</span>
<span class="x">&lt;p&gt;Some random HTML code...&lt;/p&gt;</span><span class="cp">{%</span> <span class="k">raw</span><span class="cp">%}{%</span> <span class="k">endmacro</span> <span class="cp">%}</span><span class="x">{ %endraw%}</span>
<span class="cp">{%</span><span class="k">endgeshi</span><span class="cp">%}</span><span class="x"></span>
</pre></div>

<p><em>We had to add an extra space between { and %. Can you figure out why? :-)</em></p>
    </section>
  </article>
</div>
                    
                </section>
                <hr class="ui divider" />
                <div class="ui pagination menu">
                    
                    <a class="item" href="/tag/php/2"><i class='left arrow icon'></i> Previous Posts</a>
                    
                    
                </div>
            </div>
        </div>
    </div>
</div>
        
        
        
<div class="ui inverted vertical footer segment">
  <div class="ui container">
    <div class="ui stackable inverted divided equal height stackable grid">
      <div class="three wide column">
        <h4 class="ui inverted header">Resources</h4>
        <div class="ui inverted link list">
          <a href="/about" class="item">About</a>
          <a href="/contact" class="item">Contact Us</a>
        </div>
      </div>
      <div class="three wide column">
        <h4 class="ui inverted header">Follow Us</h4>
        <div class="ui inverted link list">
          <a href="https://github.com/tupilabs" class="item"><i class="github icon"></i> GitHub</a>
          <a href="https://www.twitter.com/tupilabs" class="item"><i class="twitter icon"></i> Twitter</a>
          <a href="https://www.facebook.com/pages/TupiLabs/367986299948160" class="item"><i class="facebook icon"></i> FaceBook</a>
          <a href="http://www.youtube.com/user/TupiLabs" class="item"><i class="youtube icon"></i> YouTube</a>
        </div>
      </div>
      <div class="seven wide column">
        <h4 class="ui inverted header">Check out our lab!</h4>
        <p>Before projects are incubated in TupiLabs, we implement small proof of concepts in our
          <a href="/lab">lab</a>.
          You can check out what we are working on, and help us to make it better by telling us what
          you think.</p>
      </div>
    </div>
  </div>
</div>
    </div>
    <script src="/jquery.min.js"></script>
    <script src="/semantic.min.js"></script>
    <script src="/site.js"></script>
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
    ga('create', 'UA-27590622-1', 'auto');
    ga('send', 'pageview');
    
    </script>
</body>
</html>